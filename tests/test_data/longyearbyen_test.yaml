parameters:
  time_delta_minutes: 60 # minutes per timestep
  planning_horizon: 240 # timesteps in each rolling optimisation
  optimisation_timesteps: 24 # timesteps between each optimisation
  forecast_timesteps: 24 # timesteps beyond which forecast (instead of nowcast) profile is used
  #time_reserve_minutes: 1440 # minutes, how long stored energy must be sustained to count as reserve
  co2_tax: 2 # NOK/kgCO2 https://www.regjeringen.no/contentassets/4eeae826fa5c4e21ad186eec1d9b7873/no/pdfs/prp202120220001ls1dddpdfs.pdf
  emission_intensity_max: -1 # kgCO2/Sm3oe, -1=no limit
  emission_rate_max: -1 # kgCO2/hour, -1=no limit
  objective: costs # select objective function to use

carriers:
  - id: el
    powerflow_method: transport # transport, None, dc-pf
    el_backup_margin: -1 # MW, -1=no limit
    el_reserve_margin: 5 # MWm -1=no limit
    reserve_storage_minutes: 30 # minutes, how long stored energy must be sustained to count as reserve
  - id: heat
    heat_reserve_margin: 5
  - id: hydrogen
    #energy_value: 12.7 # MJ/Nm3 - see https://www.engineeringtoolbox.com/fuels-higher-calorific-values-d_169.html
  - id: diesel
    #energy_value: 37940  # MJ/m3 (calorific value) -> 39 MJ/m3
    #co2_content: 2629 # kg/m3


devices:
  - id: wind
    flow_max: 1
    flow_min: 1
    co2em: 0 # kgCO2/MWh_el
    investment_cost: 0
    fixed_op_cost: 0
    op_cost: 0.001 # NOK/MJ (10 NOK/MWh = 0.003 NOK/MJ)
    include: 0
    model: source_el
    name: wind_farm
    node_id: wind_farm
    #profile: V105

  - id: pv
    flow_max: 1
    flow_min: 1
    co2em: 0 # kgCO2/MWh_el
    investment_cost: 0
    fixed_op_cost: 0
    op_cost: 0.002 # NOK/MJ (10 NOK/MWh = 0.003 NOK/MJ)
    include: 0
    model: source_el
    name: pv
    node_id: pv
    #profile: PV

  - id: loadshed
    # A "generator" to cover otherwise unmet el demand - representing load shed
    include: 0
    model: source_el
    node_id: powersupply
    name: Loadshedding (dummy)
    flow_max: 1000
    # high operating (energy) cost to avoid using it unless necessary
    op_cost: 10 # NOK/MJ (= 10*3600s/h NOK/MWs = 36000 NOK/MWh)
    co2em: 0
    reserve_factor: 0 #does not contribute towards reserve

  - id: el_load
    flow_max: 1
    flow_min: 1
    include: 1
    op_cost: 0
    model: sink_el
    name: general el load
    node_id: load
    reserve_factor: 0
    profile: el_load

  - id: heat_load
    flow_max: 1
    flow_min: 1
    include: 1
    model: sink_heat
    name: heat demand
    node_id: load
    profile: heat_load

  - id: electrolyser
    include: 0
    model: electrolyser
    name: electrolyser
    node_id: h2_storage
    flow_max: 50 # MW el
    eta: 0.64 #efficiency (el to h2)
    eta_heat: 0.17 # heat recovery ratio
    reserve_factor: 1 #contributes to spinning reserve
    investment_cost: 0
    fixed_op_cost: 0
    op_cost: -0.01 #NOK/MJ (same as fuel cell - to give incentive to fill storage)

  - id: fuelcell
    include: 0
    model: fuelcell
    name: fuelcell
    node_id: h2_storage
    flow_max: 45 # MW el
    eta: 0.50 #efficiency (h2 to el)
    eta_heat: 0.4 #heat recovery ratio
    investment_cost: 0
    fixed_op_cost: 0
    op_cost: 0.02 # NOK/MJ (100 NOK/MWh = 0.03 NOK/MJ) #higher than wind, to favour wind when possible
    reserve_factor: 1 #contributes to spinning reserve
    electrolyser_id: electrolyser

  - id: h2_storage
    include: 0
    model: storage_hydrogen_compressor
    name: compressed_h2_storage
    node_id: h2_storage
    flow_max: 5
    E_min: 100
    E_max: 3000000 # Nm3  # 13 MJ/Sm3 => 10830 MWh (around 15 days at 15 MW and 50% efficiency)
    E_init: 1500000
    eta: 1
    op_cost_in: -0.05 # Fill incentive
    op_cost_out: 0 #0.01 #0.55
    investment_cost: 0
    compressor:
      eta: 0.95
      eta_heat: 0.9
      isothermal_adiabatic: 0.5 #0.0 # 0 for isothermal limit, 1 for adiabatic limit, can also be any float in between
      temperature: 300 # K 
      p_in: 1 # MPa, (10 bar) pressure of hydrogen arriving from electrolyser
      p_max: 70 # MPa, (700 bar) maximum pressure of hydrogen in storage tank
    #target_profile: h2target # "H2target", for planning beyond optimisation window
    #target_value: 500000 # Sm3, same as E_init
    
  - id: el_storage
    flow_max: 6 # MW
    include: 0
    model: storage_el
    name: el_storage
    node_id: powersupply
    E_max: 7 # MWh
    E_init: 3 # MWh
    eta: 0.95
    investment_cost: 0
    fixed_op_cost: 0
    op_cost_in: 0 #-0.001 # Slight fill incentive
    op_cost_out: 0.0015

  - id: geothermal
    include: 0
    model: heatpump
    name: geothermal
    node_id: geothermal
    flow_max: 1.3
    flow_min: 0
    eta: 4
    investment_cost: 0
    fixed_op_cost: 0
    op_cost: 0.001
    #profile: geothermal

  - id: electric_boiler
    include: 0
    model: heatpump
    name: electric_boiler
    node_id: electric_boiler
    flow_max: 5.05050505
    flow_min: 0.252525
    eta: 0.99
    investment_cost: 0
    fixed_op_cost: 0
    op_cost: 0.001
    start_stop:
      penalty_start: 0.001
      is_on_init: 0
      minimum_time_on_minutes: 60
  
  - id: heat_dump
    flow_max: 100
    flow_min: 0
    include: 1
    op_cost: 0.00001
    model: sink_heat
    name: heat_dump
    node_id: load

  - id: el_dump
    flow_max: 100
    flow_min: 0
    include: 1
    op_cost: 0.1
    model: sink_el
    name: el_dump
    node_id: load

  - id: diesel_source
    flow_max: 100
    flow_min: 0
    include: 0
    op_cost: 7590 # NOK/m3 THEMA-og-Multiconsult-Energiforsyningen-paÌŠ-Svalbard_final-1-1.pdf
    model: source_diesel
    name: diesel_source
    node_id: diesel_backup

  - id: backup_east_1
    flow_max: 1.8
    flow_min: 0.54
    fuel_A: 2.699057523809524
    fuel_B: 0.16423333333333373
    eta_heat: 0
    include: 0
    model: diesel_generator
    name: backup_east_1
    fixed_op_cost: 0
    op_cost: 0.01
    node_id: diesel_backup
    start_stop:
      penalty_start: 0.100
      is_on_init: 0
      minimum_time_on_minutes: 60

  - id: backup_east_2
    flow_max: 1.8
    flow_min: 0.54
    fuel_A: 2.699057523809524
    fuel_B: 0.16423333333333373
    eta_heat: 0
    include: 0
    model: diesel_generator
    name: backup_east_2
    op_cost: 0.011
    node_id: diesel_backup
    start_stop:
      penalty_start: 0.100
      is_on_init: 0
      minimum_time_on_minutes: 60

  - id: backup_east_3
    flow_max: 1.8
    flow_min: 0.54
    fuel_A: 2.699057523809524
    fuel_B: 0.16423333333333373
    eta_heat: 0
    include: 0
    model: diesel_generator
    name: backup_east_3
    op_cost: 0.012
    node_id: diesel_backup
    start_stop:
      penalty_start: 0.100
      is_on_init: 0
      minimum_time_on_minutes: 60

  - id: backup_west_1
    flow_max: 2
    flow_min: 0.6
    fuel_A: 2.6983536666666668
    fuel_B: 0.16320687499999964
    eta_heat: 0.6
    include: 0
    model: diesel_generator
    name: backup_west_1
    op_cost: 0.01
    node_id: diesel_backup
    start_stop:
      penalty_start: 0.100
      is_on_init: 0
      minimum_time_on_minutes: 60

  - id: backup_west_2
    flow_max: 2
    flow_min: 0.6
    fuel_A: 2.6983536666666668
    fuel_B: 0.16320687499999964
    eta_heat: 0.6
    include: 0
    model: diesel_generator
    name: backup_west_2
    op_cost: 0.011
    node_id: diesel_backup
    start_stop:
      penalty_start: 0.100
      is_on_init: 0
      minimum_time_on_minutes: 60

  - id: backup_west_3
    flow_max: 2
    flow_min: 0.6
    fuel_A: 2.6983536666666668
    fuel_B: 0.16320687499999964
    eta_heat: 0.6
    include: 0
    model: diesel_generator
    name: backup_west_3
    op_cost: 0.012
    node_id: diesel_backup
    start_stop:
      penalty_start: 0.100
      is_on_init: 0
      minimum_time_on_minutes: 60

  - id: diesel_boiler_1
    flow_max: 8.5
    flow_min: 1.275
    eta: 0.884290
    include: 0
    model: diesel_heater
    name: diesel_boiler_1
    op_cost: 0.01
    node_id: diesel_backup
    start_stop:
      penalty_start: 0.100
      is_on_init: 0
      minimum_time_on_minutes: 60

  - id: diesel_boiler_2
    flow_max: 8.5
    flow_min: 1.275
    eta: 0.884290
    include: 0
    model: diesel_heater
    name: diesel_boiler_2
    op_cost: 0.011
    node_id: diesel_backup
    start_stop:
      penalty_start: 0.100
      is_on_init: 0
      minimum_time_on_minutes: 60

  - id: boiler_houses
    flow_max: 17
    flow_min: 0.18
    eta: 0.865475
    include: 0
    model: diesel_heater
    name: boiler_houses
    op_cost: 0.01
    node_id: diesel_backup
    start_stop:
      penalty_start: 0.100
      is_on_init: 0
      minimum_time_on_minutes: 60

edges:
  - id: el_wf_ps
    flow_max: 500.0
    include: 1
    length_km: 60.0
    node_from: wind_farm
    node_to: powersupply
    reactance: 0.01
    resistance: 0.001
    carrier: el

  - id: el_pv_ps
    flow_max: 500.0
    include: 1
    length_km: 3
    node_from: pv
    node_to: powersupply
    reactance: 0.01
    resistance: 0.001
    carrier: el

  - id: el_ps_load
    flow_max: 500.0
    include: 1
    length_km: 3
    node_from: powersupply
    node_to: load
    reactance: 0.01
    resistance: 0.001
    carrier: el

  - id: heat_h2_load
    flow_max: 500.0
    include: 1
    length_km: 3
    node_from: h2_storage
    node_to: load
    carrier: heat
    
  - id: el_ps_h2
    include: 1
    node_from: powersupply
    node_to: h2_storage
    carrier: el
  
  - id: el_ps_geo
    include: 1
    node_from: powersupply
    node_to: geothermal
    carrier: el

  - id: heat_geo_load
    include: 1
    node_from: geothermal
    node_to: load
    carrier: heat

  - id: el_ps_eb
    include: 1
    node_from: powersupply
    node_to: electric_boiler
    carrier: el

  - id: heat_eb_load
    include: 1
    node_from: electric_boiler
    node_to: load
    carrier: heat

  - id: el_diesel_load
    include: 1
    node_from: diesel_backup
    node_to: load
    carrier: el

  - id: heat_diesel_load
    include: 1
    node_from: diesel_backup
    node_to: load
    carrier: heat

nodes:
  - id: wind_farm
  - id: pv
  - id: powersupply
  - id: load
  - id: h2_storage
  - id: geothermal
  - id: electric_boiler
  - id: diesel_backup